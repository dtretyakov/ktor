apply from: rootProject.file("gradle/ide.gradle")

apply plugin: "kotlinx-atomicfu"

kotlin {
    targets {
        if (project.ext.ideaActive) {
            fromPreset(project.ext.ideaPreset, 'windows')
        } else {
            fromPreset(presets.mingwX64, 'mingwX64')
        }
    }
    sourceSets {
        windowsMain.dependencies {
            implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutines_version"
            implementation "org.jetbrains.kotlinx:atomicfu:$atomicfu_version"
        }

        windowsMain { dependsOn commonMain }
        windowsTest

        if (!project.ext.ideaActive) {
            configure([mingwX64Main]) {
                dependsOn windowsMain
            }

            configure([mingwX64Test]) {
                dependsOn windowsTest
            }
        }
    }
}

project.ext.set("hasNative", true)
